<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    {% load static %}
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'css/page4.css' %}">
    <title>IIITB: Education</title>
</head>
<body>
    <nav class="navbar">
        <div class="navbar-brand">
            <img src="{% static 'images/iiitb_logo.jpg' %}" alt="iiitb-logo">
            <div class="info">
                <ul class="nav-info-link">
                    <p>Locker: Education</p>
                    <li>Owner :<a href="#">IIITB</a></li>
                </ul>
            </div>
        </div>
        <ul class="navbar-links">
            <li><a href="{% url 'page1' %}">Home</a></li>
            <li> <img src="{% static 'images/user_icon.png' %}" alt="User Icon"> </li>
        </ul>
    </nav>

    <div class="hero-container">
        <div class="new-connection">
            <h3>Education Locker of IIITB</h3>
            <button id="newConnectionBtn">Create New Connection</button>
        </div>
        <div class="connections">
            <div class="public-resources">
                <h3>Public Resources</h3>
                <h4>[Description]</h4>
                <a href="https://www.iiitb.ac.in/includefiles/userfiles/images/pdf/Research-manual-IIITB.pdf">Mtech_Manual.pdf</a>
            </div>
            <div class="my-connections">
                <h3>My Connections</h3>
                {% include 'partials/connection_list.html' %}
                    <!-- Connections will be appended here by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script src="{% static 'js/script(page4).js' %}"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            fetch('/api/connections/')
                .then(response => response.text())  // Fetch as text instead of JSON
                .then(data => {
                    const connectionList = document.getElementById('connection-list');
                    connectionList.innerHTML = data;  // Assuming data is HTML

                    // Check if either source_user or target_user is IIITB and style accordingly
                    const cards = connectionList.querySelectorAll('.card');
                    cards.forEach(card => {
                        const sourceUser = card.querySelector('.source-user').innerText;
                        const targetUser = card.querySelector('.target-user').innerText;

                        if (sourceUser.trim() === "IIITB" || targetUser.trim() === "IIITB") {
                            card.classList.add('iiitb-connection'); // Add a class for styling
                        }
                    });
                });
        });
    </script>
</body>
</html>
